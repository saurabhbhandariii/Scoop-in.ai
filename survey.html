<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
    <title>Survey Form</title>
    <style>
      /* Custom CSS for numbering questions */
      .field.question {
        counter-increment: question-counter;
        margin-bottom: 1.5rem; /* Add some space between questions */
      }

      .field.question .label::before {
        content: counter(question-counter) ". ";
        font-weight: bold;
        margin-right: 0.5rem;
      }

      /* Style for checkbox groups */
      .field.is-checkbox-group .control {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem; /* Space between checkboxes */
      }

      .field.is-checkbox-group .control .b-checkbox {
        display: flex; /* Align checkbox and label */
        align-items: center;
      }

      /* Style for radio buttons */
      .field .control .radio {
        margin-right: 1.5rem; /* Space between radio options */
      }
    </style>
  </head>
  <body>
    <section class="section">
      <div class="container">
        <h1 class="title has-text-centered">Updated Survey Test</h1>
        <p class="subtitle has-text-centered">Your insights help us understand how people interact with information online.</p>
        <form method="post" id="form" class="box" action="https://sheetdb.io/api/v1/24lsa44exos6r">
          <div class="field question is-checkbox-group">
            <label class="label">Platform(s) You Use (Select all that apply)</label>
            <div class="control">
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="YouTube" /> YouTube
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="Snapchat" /> Snapchat
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="Instagram Reels" /> Instagram Reels
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="Facebook" /> Facebook
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="TikTok" /> TikTok
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="X (Twitter)" /> X (Twitter)
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="Reddit" /> Reddit
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="platform[]" value="Other" /> Other
              </label>
            </div>
          </div>

          <div class="field question">
            <label class="label">Daily Time on Platform(s) (hours)</label>
            <div class="control">
              <input class="input" type="number" name="daily_time" id="daily_time" placeholder="e.g., 2" min="0" step="0.1" />
            </div>
          </div>

          <div class="field question is-checkbox-group">
            <label class="label">Reasons for Use (Select all that apply)</label>
            <div class="control">
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="Entertainment" /> Entertainment
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="News" /> News
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="Education" /> Education
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="Socializing" /> Socializing
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="Shopping" /> Shopping
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="Professional Networking" /> Professional Networking
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="reasons[]" value="Other" /> Other
              </label>
            </div>
          </div>

          <div class="field question">
            <label class="label">Have you seen false information on these platforms?</label>
            <div class="control">
              <label class="radio"><input type="radio" name="seen_false_info" value="yes" /> Yes</label>
              <label class="radio"><input type="radio" name="seen_false_info" value="no" /> No</label>
            </div>
          </div>

          <div class="field question">
            <label class="label">Have you believed wrong information from these platforms?</label>
            <div class="control">
              <label class="radio"><input type="radio" name="belived_wrong_info" value="yes" /> Yes</label>
              <label class="radio"><input type="radio" name="belived_wrong_info" value="no" /> No</label>
            </div>
          </div>

          <div class="field question is-checkbox-group">
            <label class="label">Category of Misinformation Seen (Select all that apply)</label>
            <div class="control">
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Health" /> Health
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Politics" /> Politics
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Science" /> Science
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Financial" /> Financial
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Current Events" /> Current Events
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Celebrity/Gossip" /> Celebrity/Gossip
              </label>
              <label class="b-checkbox checkbox">
                <input type="checkbox" name="misinfo_cat[]" value="Other" /> Other
              </label>
            </div>
          </div>

          <div class="field question">
            <label class="label">Trust Level in Platform(s) (1â€“10, 1 = No Trust, 10 = Complete Trust)</label>
            <div class="control">
              <input class="input" type="number" name="trust_level" id="trust_level" min="1" max="10" />
            </div>
          </div>

          <div class="field question">
            <label class="label">Do you use any fact-checking tools?</label>
            <div class="control">
              <label class="radio"><input type="radio" name="use_tool" value="yes" /> Yes</label>
              <label class="radio"><input type="radio" name="use_tool" value="no" /> No</label>
            </div>
          </div>

          <div class="field question">
            <label class="label">Preferred Fact-Checking Tool (if any)</label>
            <div class="control">
              <input class="input" type="text" name="tool_prefrence" id="tool_prefrence" placeholder="e.g., Google Fact Check, Snopes, PolitiFact" />
            </div>
          </div>

          <div class="field question">
            <label class="label">Why do you trust this platform (or not)?</label>
            <div class="control">
              <textarea class="textarea" name="trust_reason" id="trust_reason" placeholder="Explain your reason"></textarea>
            </div>
          </div>

          <div class="field question">
            <label class="label">Do you access news early on this platform?</label>
            <div class="control">
              <label class="radio"><input type="radio" name="early)access" value="yes" /> Yes</label>
              <label class="radio"><input type="radio" name="early)access" value="no" /> No</label>
            </div>
          </div>

          <div class="field question">
            <label class="label">Email Address (Optional)</label>
            <div class="control">
              <input class="input" type="email" name="email" id="email" placeholder="you@example.com" />
            </div>
          </div>

          <div class="field question">
            <label class="label">Country</label>
            <div class="control">
              <input class="input" type="text" name="country" id="country" placeholder="Your country" />
            </div>
          </div>

          <div class="field question">
            <label class="label">Age Range</label>
            <div class="control">
              <div class="select is-fullwidth">
                <select name="age_range" id="age_range">
                  <option value="">-- Select Age Range --</option>
                  <option value="Under 18">Under 18</option>
                  <option value="18-24">18-24</option>
                  <option value="25-34">25-34</option>
                  <option value="35-44">35-44</option>
                  <option value="45-54">45-54</option>
                  <option value="55+">55+</option>
                </select>
              </div>
            </div>
          </div>

          <div class="field question">
            <label class="label">Language</label>
            <div class="control">
              <input class="input" type="text" name="language" id="language" placeholder="e.g., English, Spanish" />
            </div>
          </div>

          <div class="field is-grouped">
            <div class="control">
              <button type="submit" class="button is-link" id="submit-button">Submit</button>
            </div>
            <div class="control">
              <button type="button" class="button is-light">Cancel</button>
            </div>
          </div>

          <div id="message" style="display: none; padding: 10px; border-radius: 4px; margin-top: 1rem;"></div>
        </form>
      </div>
    </section>

    <script>
      const form = document.getElementById("form");
      const submitButton = document.getElementById("submit-button");
      const messageDiv = document.getElementById("message");

      form.addEventListener("submit", async function (e) {
        e.preventDefault();
        messageDiv.textContent = "Submitting...";
        messageDiv.style.display = "block";
        messageDiv.style.backgroundColor = "beige";
        messageDiv.style.color = "black";
        submitButton.disabled = true;
        submitButton.classList.add("is-loading");

        try {
          const formData = new FormData(this);
          const formDataObj = {};

          // Collect all form data, handling multiple selections for checkboxes
          for (let [key, value] of formData.entries()) {
            if (key.endsWith('[]')) { // Check if it's a checkbox array
              const fieldName = key.slice(0, -2); // Remove '[]'
              if (!formDataObj[fieldName]) {
                formDataObj[fieldName] = [];
              }
              formDataObj[fieldName].push(value);
            } else {
              formDataObj[key] = value;
            }
          }

          // Convert checkbox arrays to comma-separated strings for SheetDB
          for (const key in formDataObj) {
              if (Array.isArray(formDataObj[key])) {
                  formDataObj[key] = formDataObj[key].join(', ');
              }
          }

          const scriptURL = this.action;

          const response = await fetch(scriptURL, {
            redirect: "follow",
            method: "POST",
            body: JSON.stringify(formDataObj),
            headers: {
              "Content-Type": "application/json",
            },
          });

          const data = await response.json();

          if (data.status === "success" || response.ok) {
            messageDiv.textContent = "Data submitted successfully!";
            messageDiv.style.backgroundColor = "#48c78e";
            messageDiv.style.color = "white";
            form.reset();
            // Redirect to index.html after a short delay
            setTimeout(() => {
              window.location.href = "index.html";
            }, 1500); // Redirect after 1.5 seconds so user can see success message
          } else {
            throw new Error(data.message || `Submission failed with status: ${response.status}`);
          }
        } catch (error) {
          console.error("Error:", error);
          messageDiv.textContent = "Error: " + error.message;
          messageDiv.style.backgroundColor = "#f14668";
          messageDiv.style.color = "white";
        } finally {
          submitButton.disabled = false;
          submitButton.classList.remove("is-loading");
         
        }
      });

      // Cancel button resets form
      const cancelButton = form.querySelector("button.is-light");
      cancelButton.addEventListener("click", () => {
        form.reset();
        messageDiv.style.display = "none";
      });
    </script>
  </body>
</html>
